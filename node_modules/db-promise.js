"use strict";

function allPromise(db, query) {
	var placeholders = Array.prototype.slice.call(arguments, 2);
	return new Promise((resolve, reject) => {
		db.all(query, placeholders, (err, rows) => {
			if (err) {
				console.error(`Encountered an error: ${err.message}`);
				console.error(`\twhile running query: ${query}`);
				reject(err);
			} else {
				resolve(rows);
			}
		});
	});
}

function runPromise(db, query) {
	var placeholders = Array.prototype.slice.call(arguments, 2);
	return new Promise((resolve, reject) => {
		db.run(query, placeholders, function(err) {
			if (err) {
				console.error(`Encountered an error: ${err.message}`);
				console.error(`\twhile running query: ${query}`);
				reject(err);
			} else {
				resolve(this.lastID, this.changes);
			}
		});
	});
}

module.exports.all = allPromise;
module.exports.run = runPromise;